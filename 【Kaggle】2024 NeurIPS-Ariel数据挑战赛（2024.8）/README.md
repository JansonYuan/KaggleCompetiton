# 【Kaggle】2024 NeurIPS-Ariel数据挑战赛

说明：本项目中包含了部分方案解析、录播课件、baseline、以及推荐资料等，欢迎大家关注点赞+收藏！！！

比赛名称：2024 NeurIPS-Ariel数据挑战赛

比赛链接：https://www.kaggle.com/competitions/ariel-data-challenge-2024

比赛任务：这是一个**回归问题**。你的任务是构建模型，对Ariel任务的模拟观测数据进行**去趋势处理**，最终**提取出系外行星的大气光谱（spectra）并估计其不确定性（uncertainty）**。

![CleanShot 2025-09-05 at 16.42.40@2x](/Users/apple/Library/Application Support/CleanShot/media/media_rjcxVKCWZ5/CleanShot 2025-09-05 at 16.42.40@2x.png)

![CleanShot 2025-09-05 at 15.48.26@2x](/Users/apple/Downloads/【Kaggle】 Optiver - Trading at the close（2023.10）/assets/CleanShot 2025-09-05 at 15.48.26@2x.png)

---

<img src="assets/20250904_174246_5b2bcaaac91a0105f71ca56604b8dcb5.png" style="width:500px;" />

欢迎大家了解我们深度之眼，希望能够给大家带去最实用的知识：

https://deepshare.feishu.cn/wiki/Tb7IwetysiLErGk3NQwcQdHznPb?from=from_copylink

---

## 1、比赛简介

自上世纪90年代首次发现系外行星（围绕其他恒星运行的行星）以来，我们已经发现了数千颗这样的天体。天文学家们不再满足于仅仅“发现”它们，而是渴望**“理解”**它们。

- **核心科学问题**：这些遥远的世界是由什么构成的？它们的大气层是怎样的？是否存在水、甲烷、二氧化碳等关键分子？甚至，是否存在可能暗示生命活动的“生物标志物”？
- **Ariel任务的宏伟目标**：Ariel是世界上第一个专门用于**大规模普查系外行星大气化学成分**的太空望远镜。它计划于2029年发射，将在其4年的任务寿命期间，**对大约1000颗系外行星**进行精细观测，绘制它们的大气光谱图，从而回答上述问题。

## **2、时间安排**

2024 年 8 月  1 日 - 比赛开始日期

2024 年 10 月 24 日 - 报名截止日期 & 团队合并截止日期	

2024 年 10 月  31 日 - 最终提交截止日期

## **3、整个课程的讲解思路和讲课逻辑是怎么样的？**

**1. 核心任务**

这是一个**天文学中的数据清洗和信号提取问题**，本质上是一个**多模态回归任务**。目标是从高噪声、多维的时间序列图像数据中，恢复出微弱但关键的光谱信号。

**2. 面向实操**

重点在于掌握**多模态数据处理**（整合来自AIRS-CH0和FGS1的信号及多种校准数据）、**时间序列分析**、**噪声建模与过滤**，以及能够**量化不确定性**的回归模型。

**3. 关键挑战**

- **信噪比极低**：目标信号极其微弱，远低于噪声水平，是本次竞赛的核心难点。
- **数据复杂性高**：需处理多维时间序列图像、多种校准数据以及恒星-行星系统的元数据。
- **不确定性估计**：不仅需要准确预测光谱，还需可靠地估计其不确定性，这对评估科学发现的可靠性至关重要。
- **计算规模**：数据量庞大（例如，每个行星的信号文件包含135,000行图像），对计算效率和内存管理要求高。

**4. 优化路径**

从**基于传统去趋势方法或简单模型**的基线开始，逐步引入**更复杂的深度学习模型（如CNN、RNN、Transformer）** 来处理时空特征，并集成**贝叶斯方法或分位数回归**来估计不确定性，最终通过**模型集成**和**后处理**提升性能。

**第 01 课：比赛介绍与 Baseline**

**核心内容**

1. **比赛背景**
   - **目标**：推动天文数据分析的前沿，为未来的Ariel任务做好准备。你的工作可能加速系外行星研究，并帮助回答“我们在宇宙中是否孤独”这一深刻问题。
   - **任务**：从嘈杂的望远镜观测数据中提取系外行星大气光谱并估计不确定性。
   - **评价指标**：**高斯对数似然（GLL）**。
2. **数据集概览**
   - **核心数据**：
     - `[train/test]/[planet_id]/[AIRS-CH0或FGS1]_signal.parquet`：包含展平后的时间序列图像信号。
     - `[train/test]/[planet_id]/[AIRS-CH0或FGS1]_calibration/`：包含暗场、平场、死像素图、读出噪声、线性校正等关键校准数据。
     - `train_labels.csv`：真实光谱。
     - `[train/test]_adc_info.csv`：模数转换参数（增益、偏移），用于恢复数据的原始动态范围。
   - **其他文件**：`wavelengths.csv`, `axis_info.parquet`等。
3. **Baseline 思路**
   - **数据处理**：学习如何读取和解析parquet文件，利用校准数据（如暗场、平场）对原始信号进行初步校正。
   - **基础模型**：可以考虑从**线性模型**或**简单的神经网络**开始，尝试对校正后的时间序列数据进行建模，初步预测光谱。

**第 02 课：数据预处理与特征工程**

**核心内容**

1. **数据预处理**
   - **校准流程**：利用提供的校准数据（`dark.parquet`, `flat.parquet`, `dead.parquet`, `read.parquet`, `linear_corr.parquet`）对原始信号（`signal.parquet`）进行校正，这是还原真实信号的关键一步。
   - **ADC参数应用**：使用 `adc_info.csv`中的增益（gain）和偏移（offset）参数，恢复数据的原始动态范围。
2. **特征工程**
   - **时空特征提取**：从校正后的时间序列图像中提取特征。考虑到数据是序列化的图像，可以尝试使用**CNN**来捕捉空间模式（如恒星像斑的形状），使用**RNN**（如LSTM）或**Transformer**来建模时间依赖性。
   - **多源数据融合**：思考如何有效融合AIRS-CH0和FGS1两个仪器的数据，以及如何融入元数据信息（如恒星参数）。

**第 03 课：模型选择与训练策略**

**核心内容**

1. **模型架构**
   - **卷积神经网络（CNN）**：适用于处理展平前的图像数据（需重构为2D），提取空间特征。
   - **循环神经网络（RNN）**：如LSTM或GRU，用于建模信号随时间的变化。
   - **Transformer**：善于捕捉长序列中的依赖关系，可用于时间序列分析。
   - **混合模型**：**CNN + RNN** 或 **CNN + Transformer** 的架构可能非常有效，先用CNN处理每个时间步的图像，再用RNN/Transformer处理时间维度。
   - **贝叶斯神经网络或分位数回归**：用于估计预测的不确定性，满足竞赛要求。
2. **训练技巧**
   - **损失函数**：直接使用**高斯负对数似然损失**（与评估指标GLL一致）是自然的选择。
   - **验证策略**：由于数据按行星组织，需谨慎划分训练集和验证集，防止信息泄露。

**第 04 课：不确定性估计与集成学习**

**核心内容**

1. **不确定性估计**
   - 这是比赛的核心要求之一。除了贝叶斯方法，还可以考虑：
     - **分位数回归**：直接预测光谱的不同分位数，进而推导出不确定性区间。
     - **集成方法**：使用**Deep Ensemble**（多个模型集成）或**Dropout as a Bayesian Approximation**（MC Dropout）来估计预测的不确定性。
2. **集成学习**
   - **同类模型集成**：训练多个相同架构但不同初始化的模型，对其预测结果进行平均，可以提升稳定性和性能。
   - **异类模型集成**：融合不同架构模型（如CNN-based模型和Transformer-based模型）的预测结果。

**第 05 课：往届经验与避坑指南**

**核心内容**

1. **常见挑战与解决方案**
   - **数据规模与计算**：数据量巨大，需优化数据加载和预处理流程，必要时在数据下游使用。
   - **信号微弱**：模型需要有强大的特征提取和去噪能力，深度学习模型相比传统方法更有优势。
   - **过拟合**：使用正则化技术（如Dropout、权重衰减）、早停（Early Stopping）等。
2. **避坑指南**
   - **忽视校准数据**：校准步骤对于还原真实物理信号至关重要，绝不能跳过。
   - **忽略不确定性**：只关注光谱预测精度而忽视不确定性估计，会导致最终得分不高。
   - **不理解评估指标**：深刻理解GLL指标的含义，它同时奖励**准确的光谱预测**和**校准良好的不确定性估计**。低估不确定性（过于自信）或高估不确定性（过于保守）都会受到惩罚。

---

说明：需要课程回放的同学可以扫码，凭点赞截图找小享免费领取哦！！！

<img src="assets/20250904_172853_image.png" style="width:200px;" />
