# 【Kaggle】实时市场数据预测金融竞赛

说明：本项目中包含了部分方案解析、录播课件、baseline、以及推荐资料等，欢迎大家关注点赞+收藏！！！

比赛名称：实时市场数据预测金融竞赛

比赛链接：https://www.kaggle.com/competitions/jane-street-real-time-market-data-forecasting

比赛任务：你的任务是构建一个模型，利用历史市场特征数据，**预测未来一段时间内 `response_6` 的值**。预测需要在**未来最长六个月**的时间范围内进行。

![CleanShot 2025-09-05 at 15.48.26@2x](/Users/apple/Downloads/【Kaggle】 Optiver - Trading at the close（2023.10）/assets/CleanShot 2025-09-05 at 15.48.26@2x.png)

---

<img src="assets/20250904_174246_5b2bcaaac91a0105f71ca56604b8dcb5.png" style="width:500px;" />

欢迎大家了解我们深度之眼，希望能够给大家带去最实用的知识：

https://deepshare.feishu.cn/wiki/Tb7IwetysiLErGk3NQwcQdHznPb?from=from_copylink

---

## 1、比赛简介

Jane Street实时市场数据预测竞赛由全球顶尖量化交易公司Jane Street主办。该竞赛要求参赛者使用来自生产系统的、经过匿名化处理的真实市场数据（包含79个特征和9个响应者）来构建模型，预测特定响应者`responder_6`在未来六个月的表现。赛事旨在挑战金融市场建模中的经典难题，如厚尾分布、非平稳时间序列以及市场行为的突然变化。评估指标为样本加权零均值R平方分数。

## **2、时间安排**

2024 年 10 月  14 日 - 比赛开始日期

2025 年 1 月  6 日 - 参赛作品提交截止日期 & 团队合并截止日期

2025 年 1 月  13 日- 最终提交截止日期

2025 年 7 月 12 日 - 比赛结束日期

## **3、整个课程的讲解思路和讲课逻辑是怎么样的？**

#### **1. 核心任务**

这是一个**金融高频时间序列回归预测问题**。目标不是预测直接的金融产品价格，而是预测一个能代表市场响应、经过匿名化处理的中间变量 (`response_6`)。

#### **2. 面向实操**

重点在于掌握**金融时间序列数据处理**、**特征工程** 以及适合时序预测的**机器学习/深度学习模型**。由于数据规模庞大（约450万行），**代码的效率**和**计算资源的优化**也至关重要。

#### **3. 关键挑战**

**金融数据的特殊性**：必须处理数据的**厚尾分布**、**非平稳性**和**结构性变化**（如市场机制转换）**避免过拟合**：金融市场噪声极大，模型需要强大泛化能力，防止在历史数据上过拟合，而在未知的未来数据上表现不佳。**计算效率**：处理百万行级别的高频数据对特征计算和模型训练速度都是考验

#### **4. 优化路径**

从**基线模型（如线性模型、LightGBM/XGBoost）** 开始，逐步过渡到**复杂的深度学习模型（如LSTM, Transformer时间序列变体）**，并通过**集成学习**和**持续在最新数据上验证**来提升模型稳健性和表现

#### **01课 比赛介绍与Baseline**

**核心内容**

**比赛背景**

- **目标**：使用真实生产数据构建模型，预测匿名响应者 `response_6`，应对金融市场建模的难点（厚尾分布、非平稳时间序列、市场行为突变）
- **任务**：开发一个能够根据给定的市场特征（`feature_00` 到 `feature_78`）预测 `response_6` 值的回归模型。
- **评价指标**：**加权零均值R平方分数**（Weighted Zero-Mean R²），专注于 `response_6`

**数据集概览**

- **训练数据**：`train.parquet`（包含 `date_id`, `time_id`, `symbol_id`, `weight`, `feature_{00..78}`, `responder_{0..8}`）。
- **测试数据**：`test.parquet`（包含 `id`, `is_scored`, `feature_{00..78}` 等）。
- **关键字段**：`responder_6`（目标标签），`weight`（计算评分函数的权重），`is_scored`（表示该行是否参与评分）。

**Baseline工具**

- **基础代码**：使用梯度提升树模型（如 **LightGBM** 或 **XGBoost**）作为起点，处理表格数据效率高
- **进阶思路**：考虑使用深度学习模型（如 **GRU**、**LSTM** 或 **Transformer**）捕捉更复杂的时间序列依赖关系

#### **02课 特征工程与模型搭建**

**核心内容**

**特征工程**  **数据预处理**：处理缺失值（如用零填充）、标准化处理。选择稳定的数据起始点（例如 `date_id >= 700`）

**特征构造**：**滞后特征 (Lag Features)**：获取目标或特征的滞后值。**滚动统计特征**：计算窗口期的均值、标准差等（如最近1000个 `time_id` 的滚动均值和标准差） **横截面特征**：计算特定 `date_id` 或 `time_id` 截面上所有金融工具的特定特征均值，反映市场整体状态

**其他特征**：添加 `time_id` 本身作为特征

**模型选择**：**预训练模型**：**LightGBM/XGBoost**（基线首选）、**GRU/LSTM**（捕捉时序依赖）、**Transformer**（处理长序列）**训练技巧**：**时间序列交叉验证**（防止数据泄露），**早停法**防止过拟合，使用**加权损失函数**（考虑样本权重）

**改进路线**

- **应对数据挑战**：通过特征工程和模型选择来应对厚尾分布和非平稳性。
- **利用辅助目标**：除了主目标 `response_6`，还可以利用其他 `responder`（如 `responder_7`, `responder_8`）作为辅助目标进行多任务学习，提升模型表现

#### **03课 数据增强与鲁棒性**

**核心内容**

1. **增强策略（针对时序数据）** ∙金融时间序列的增强需格外谨慎，避免破坏其内在的时序关系和统计特性。 ∙**对抗性验证**：检查训练集和测试集分布是否一致，判断模型泛化能力。 ∙**伪标签技术**：对测试集高置信度的预测结果进行伪标注，扩充训练数据（需非常谨慎，避免误差累积）。
2. **关键焦点** ∙金融时序数据的“增强”更侧重于**模型的鲁棒性**和**泛化能力**，通过使用不同时间段的验证集、模拟市场机制转换等方法来提升。
3. **效果评估** ∙任何数据增强或合成方法都必须经过严格的时间序列交叉验证，确保其真正提升模型在未知时间段上的预测能力，而非引入噪声。

#### **04课 模型集成与高级策略**

**核心内容**

**集成技术**

**基础方法**：对同一模型在不同随机种子下的训练结果进行**简单平均**或**加权平均**

**进阶方法**：

**异构模型集成**：融合不同架构模型的预测结果（例如，结合树模型和神经网络模型的预测）

**在线学习 (Online Learning)**：在推理过程中，当获取到新的带有真实目标值的数据时，以较小的学习率实时更新模型权重，这对提升模型在变化市场中的适应性非常有效

**高级工具与策略**

- **自动化调参**：使用 **Optuna** 或 **Hyperopt** 等进行超参数优化。
- **代码优化与部署**：优化特征计算和模型推理速度以满足评估API的时间要求（例如，目标是将单个 `time_id` 的推理时间控制在0.1秒以内）可能需要使用更强大的计算资源（如云GPU服务器）

#### **05课 历史方案与避坑指南**

**核心内容**

**往届优秀方案分析（参考该竞赛及类似竞赛）** **常见思路**：**特征工程**（滚动统计、横截面特征）、**模型选择**（LightGBM, GRU, Transformer）、**集成学习**（模型平均、堆叠）、**在线学习**

**关键发现**：**GRU模型配合在线学习**在后续私人测试集（预测阶段）表现突出。辅助目标损失函数可能带来提升

**避坑指南**

**避免数据泄露**：严格进行**时间序列交叉验证**，绝对禁止使用未来数据。熟悉并正确使用官方提供的**评估API**来模拟实时预测环境

**关注计算限制与效率**：优化代码，确保在评估API要求的时间限制内完成预测

**模型稳健性 over 过拟合**：不要过分追求在公开排行榜（Public LB）上的分数，更要关注模型在私人排行榜（Private LB）即未知未来数据上的泛化能力。一个在历史数据上表现稍逊但更稳健的模型，可能比一个过拟合的复杂模型在最终排名中更优。

#### **06课 比赛总结与复盘**

**核心内容**

**最终调优**

**模型压缩**：如果模型过于复杂，考虑知识蒸馏或量化以加速推理，但需平衡性能与速度

**提交验证**：确保提交格式符合要求，并通过评估API完整测试提交流程。

**复盘方向** **未充分利用的信息**：思考如何更好地理解和利用 `symbol_id`（不同的金融工具）以及 `date_id`/`time_id` 背后可能隐含的周期性和结构性变化。 **未来优化**：探索更高效的架构（如更先进的Transformer变体）、更精细化的在线学习策略、以及更强大的偏差检测和缓解技术。

---

说明：需要课程回放的同学可以扫码，凭点赞截图找小享免费领取哦！！！

<img src="assets/20250904_172853_image.png" style="width:200px;" />
